<<<<<<< HEAD
# Домашнее задание по лекции "`Репликация и масштабирование. Часть 1`" - `Попов Всеволод`

### Задание 1

На лекции рассматривались режимы репликации master-slave, master-master, опишите их различия.

`Master-Slave` репликация

Представляет собой иерархичную структуру, где одна база данных является главным узлом ("master"), принимающим запросы на запись и обновление данных, а остальные базы выступают подчинёнными ("slave") и выполняют лишь роль резервных копий, обеспечивая быстрое выполнение запросов на чтение. Главный узел контролирует процесс распространения изменений среди подчинённых узлов. Если главная база выходит из строя, система продолжает функционировать благодаря наличию резервных копий, хотя временно утрачивается способность писать новые данные.
Это решение оптимально подходит для приложений с преобладанием операций чтения над записями, таких как веб-сайты, социальные сети или онлайн-магазины, поскольку оно эффективно распределяет нагрузку на слэйвы, повышая общую пропускную способность запросов на чтение.

`Master-Master` репликация

При таком подходе две или более базы данных являются равнозначными и способны самостоятельно записывать изменения, передавая их друг другу синхронно. Таким образом, каждая база становится автономной единицей обработки записей и способна обслуживать пользователей независимо. Такое решение улучшает устойчивость системы к отказам отдельных компонентов, позволяя избежать зависимости от центрального узла.
Однако подобная конфигурация значительно сложнее в настройке и управлении, особенно важно правильно настроить механизмы разрешения конфликтов и устранения дублирования записей. Используется там, где важна высокая доступность и распределенность ресурсов, например, в высоконагруженных системах, работающих круглосуточно и глобально распространяющих данные.

Подводя итог, выбор между этими методами зависит от приоритетов проекта: если важнее быстрая обработка запросов на чтение и низкая стоимость инфраструктуры, выбирают схему Master-Slave. Для проектов, нуждающихся в повышенной доступности и возможности распределять нагрузку равномерно между несколькими узлами, предпочтительнее выбрать вариант Master-Master.

### Задание 2

Выполните конфигурацию master-slave репликации, примером можно пользоваться из лекции.
Приложите скриншоты конфигурации, выполнения работы: состояния и режимы работы серверов.

1. Создаём 2 инстанса MySQL
![Скриншот-1](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/1.png)
![Скриншот-2](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/2.png)
2. Настраиваем на каждом конфигурационный файл my.cnf
![Скриншот-3](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/3.png)
![Скриншот-4](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/4.png)
3. На мастере создаём пользователя для подключения реплики
![Скриншот-5](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/5.png)
4. На реплике изменяем источник данных для журнала
![Скриншот-6](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/6.png)
5. Подключаем инстансы к сети
![Скриншот-7](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/7.png)
6. Запускаем репликацию

7. Убеждаемся, что созданная на мастере таблица доступна на слейве
![Скриншот-8](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/8.png)
=======
# Домашнее задание по лекции "`Домашнее задание к занятию «SQL. Часть 2»`" - `Попов Всеволод`

### Задание 1

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию:
- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

`SELECT b.name, b.city, COUNT(a.store_id) AS clients`
`FROM sakila.staff_list b LEFT JOIN sakila.customer a `
`ON b.id = a.store_id`
`GROUP BY b.name, b.city`
`HAVING clients > 300;`

![Скриншот-1](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/screen_12.png)

### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

`SELECT COUNT(*) AS result`
`FROM sakila.film`
`WHERE length > (SELECT AVG(length) from sakila.film);`

![Скриншот-2](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/screen_22.png)

### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.

`SELECT MONTH(payment_date) AS payment_month, SUM(amount) AS total_amount, `
`Count(*) AS rental_count`
`FROM sakila.payment`
`GROUP BY payment_month`
`ORDER BY total_amount DESC`
`LIMIT 1;`

![Скриншот-3](https://github.com/MeSeurus/sys-pattern-homework/blob/main/img/screen_32.png)

UPD:
Исправленный вариант:

`SELECT EXTRACT(YEAR FROM payment_date) AS payment_year, EXTRACT(MONTH FROM payment_date) AS payment_month, SUM(amount) AS total_amount,  Count(*) AS rental_count`
`FROM sakila.payment`
`GROUP BY payment_year, payment_month`
`ORDER BY total_amount DESC`
`LIMIT 1;`

+--------------+---------------+--------------+--------------+
| payment_year | payment_month | total_amount | rental_count |
+--------------+---------------+--------------+--------------+
|         2005 |             7 |     28368.91 |         6709 |
+--------------+---------------+--------------+--------------+

UPD2:
Добавил через DATE_FORMAT

`SELECT DATE_FORMAT(payment_date, ‘%Y-%m’) AS payment_month, SUM(amount) AS total_amount,  Count(*)AS rental_count`
`FROM sakila.payment`
`GROUP BY payment_month`
`ORDER BY total_amount DESC`
`LIMIT 1;`
>>>>>>> a4de12dc60c3f5cd068af409b8273e0ec6d95078
